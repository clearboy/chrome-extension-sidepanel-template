# Chrome Extension - Ariba AI Assistant 设计文档

## 1. 项目概述

### 1.1 项目名称
**Ariba AI Assistant **

### 1.2 项目目标
开发一个 Chrome 扩展,实现以下核心功能:
1. 在侧边栏中调用 AI 智能体进行问答
2. 将 AI 返回的结果自动填充到 Ariba 网站的特定页面

### 1.3 目标用户
**Ariba用户**

- 用户角色: 宁波华翔的业务用户
- 使用频率: 每个月两三次
- 主要痛点: Ariba操作比较麻烦，用户不容易选择其中的品类。

---

## 2. AI 智能体配置

- [x] 已经完成



---

## 3. Ariba 网站集成

### 3.1 目标页面识别

#### 3.1.1 页面 URL 模式
**[请提供需要填充的 Ariba 页面 URL 规则]**

```
示例:
- https://[company].ariba.com/Sourcing/Main/ad/createSourcingRequest/*
- https://[company].ariba.com/Buyer/Main/ad/purchaseOrder/*
```

你的 URL 模式:
```
[请填写]
```

#### 3.1.2 页面识别方式
**[如何确认这是正确的页面]**

- [ ] URL 匹配
- [ ] 页面标题包含: ___________
- [ ] 特定 DOM 元素存在: ___________
- [ ] 其他: ___________

### 3.2 表单字段映射

#### 3.2.1 需要填充的字段列表
**[请详细列出所有需要自动填充的字段]**

| 字段序号 | 字段名称 | 字段类型 | CSS Selector / XPath | 是否必填 | 数据来源 | 备注 |
|---------|---------|---------|---------------------|---------|---------|------|
| 1 | [例: 采购描述] | textarea | #description | 是 | AI 回答 | |
| 2 | | | | | | |
| 3 | | | | | | |
| 4 | | | | | | |
| 5 | | | | | | |
| 6 | | | | | | |
| 7 | | | | | | |

**[请根据实际需求添加更多行]**

#### 3.2.2 字段类型处理规则

**文本输入框 (input[type="text"])**
```
处理方式: [请填写]
```

**文本域 (textarea)**
```
处理方式: [请填写]
```

**下拉选择框 (select)**
```
处理方式: [请填写]
是否需要模糊匹配: [ ] 是  [ ] 否
```

**单选框 (radio)**
```
处理方式: [请填写]
```

**复选框 (checkbox)**
```
处理方式: [请填写]
```

**日期选择器 (date picker)**
```
处理方式: [请填写]
特殊组件库: [如 SAP UI5, React DatePicker 等]
```

**富文本编辑器 (Rich Text Editor)**
```
处理方式: [请填写]
编辑器类型: [如 TinyMCE, CKEditor, Quill 等]
```

**文件上传**
```
是否需要: [ ] 是  [ ] 否
处理方式: [请填写]
```

### 3.3 数据转换规则

#### 3.3.1 AI 输出到表单字段的映射
**[请定义从 AI 返回的数据到表单字段的映射关系]**

```javascript
// 示例映射规则
{
  "aiResponse.description": "form.field.#description",
  "aiResponse.quantity": "form.field.#quantity",
  "aiResponse.category": "form.select.#category"
}
```

你的映射规则:
```
[请填写]
```

#### 3.3.2 数据验证规则
**[填充前后需要进行的验证]**

- [ ] 必填字段检查
- [ ] 数据格式验证 (如日期、数字、邮箱等)
- [ ] 字符长度限制
- [ ] 其他: ___________

---

## 4. 用户界面设计

### 4.1 SidePanel (侧边栏) 界面

#### 4.1.1 布局结构
**[请描述你期望的界面布局]**

```
┌─────────────────────────────┐
│ [顶部区域]                   │
│ - 标题/Logo                  │
│ - 设置按钮                   │
├─────────────────────────────┤
│ [对话历史区域]               │
│ - 用户问题                   │
│ - AI 回答                    │
│ - 滚动显示                   │
│                             │
│                             │
├─────────────────────────────┤
│ [输入区域]                   │
│ - 文本输入框                 │
│ - 发送按钮                   │
├─────────────────────────────┤
│ [操作区域]                   │
│ - 填充按钮                   │
│ - 清空对话                   │
│ - [其他功能按钮]             │
└─────────────────────────────┘
```

是否需要调整: ___________

#### 4.1.2 功能区域详细说明

**对话历史区域**
- 显示方式: [请填写,如气泡对话、列表等]
- 是否需要保存历史: [ ] 是  [ ] 否
- 历史保存时长: ___________

**输入区域**
- 是否支持多行输入: [ ] 是  [ ] 否
- 是否支持快捷键发送 (Enter): [ ] 是  [ ] 否
- 最大字符限制: ___________

**填充功能**
- 填充按钮触发条件: [请填写,如"必须在 Ariba 页面上"]
- 是否支持部分字段选择填充: [ ] 是  [ ] 否
- 填充前是否需要用户确认: [ ] 是  [ ] 否

#### 4.1.3 UI 样式偏好
**[请描述界面风格]**

- 色彩方案: [如企业蓝、简洁白、深色模式等]
- 主色调: ___________
- 辅助色: ___________
- 字体大小: ___________

### 4.2 设置页面 (Options Page)

#### 4.2.1 需要配置的项目
**[请勾选需要的配置项]**

- [ ] AI API Key 配置
- [ ] AI Model 选择
- [ ] 字段映射规则自定义
- [ ] 自动填充开关
- [ ] 对话历史保留设置
- [ ] 快捷键自定义
- [ ] 其他: ___________

#### 4.2.2 高级功能需求
- [ ] 导入/导出配置
- [ ] 多套配置方案切换
- [ ] 调试模式
- [ ] 日志查看

---

## 5. 数据流设计

### 5.1 完整流程
**[请确认或调整以下流程]**

```
1. 用户在 SidePanel 输入问题
   ↓
2. 问题发送到 Background Script
   ↓
3. Background Script 调用 AI API
   ↓
4. AI 返回结构化数据
   ↓
5. 数据发送到 Content Script
   ↓
6. Content Script 解析数据并填充表单
   ↓
7. 用户确认并提交
```

是否需要调整: ___________

### 5.2 错误处理

#### 5.2.1 API 调用失败
**[请填写期望的处理方式]**

- [ ] 显示错误提示
- [ ] 自动重试 (重试次数: _______)
- [ ] 降级到其他 AI 服务
- [ ] 其他: ___________

#### 5.2.2 字段填充失败
**[请填写期望的处理方式]**

- [ ] 高亮显示失败字段
- [ ] 显示错误原因
- [ ] 允许手动填充
- [ ] 其他: ___________

#### 5.2.3 网络问题
**[请填写期望的处理方式]**

- 超时时间设置: _______ 秒
- 处理方式: ___________

---

## 6. 安全与隐私

### 6.1 API Key 存储
**[请选择存储方式]**

- [ ] chrome.storage.local (本地存储)
- [ ] chrome.storage.sync (同步存储)
- [ ] 不存储,每次输入
- [ ] 其他: ___________

### 6.2 数据隐私
**[请确认以下隐私政策]**

- [ ] 不会将用户输入的数据存储到第三方服务器(除 AI API)
- [ ] 对话历史仅保存在本地
- [ ] 不会收集用户的 Ariba 账户信息
- [ ] 其他承诺: ___________

### 6.3 权限最小化原则
**[请确认需要的权限]**

当前权限:
- [x] activeTab (访问当前标签页)
- [x] sidePanel (使用侧边栏)

额外需要的权限:
- [ ] storage (存储数据)
- [ ] scripting (动态注入脚本)
- [ ] host_permissions (特定域名权限): ___________
- [ ] 其他: ___________

---

## 7. 性能与优化

### 7.1 性能指标
**[请填写性能要求]**

- AI 响应时间要求: _______ 秒内
- 表单填充时间: _______ 秒内
- 扩展体积限制: _______ MB

### 7.2 优化策略
**[请选择需要的优化]**

- [ ] AI 响应缓存 (相同问题不重复调用)
- [ ] 字段映射缓存
- [ ] 懒加载组件
- [ ] 代码分割
- [ ] 其他: ___________

---

## 8. 测试计划

### 8.1 测试环境
**[请提供测试环境信息]**

- Ariba 测试环境 URL: ___________
- 测试账号: [是否可提供]
- Chrome 版本要求: ___________

### 8.2 测试用例
**[请列出关键测试场景]**

| 测试场景 | 输入 | 期望输出 | 优先级 |
|---------|------|---------|--------|
| 1. 基本问答 | | | 高 |
| 2. 字段填充 - 文本 | | | 高 |
| 3. 字段填充 - 下拉框 | | | 高 |
| 4. 错误处理 | | | 中 |
| 5. | | | |

---

## 9. 部署与发布

### 9.1 发布渠道
**[请选择发布方式]**

- [ ] Chrome Web Store (公开发布)
- [ ] 企业内部分发 (.crx 文件)
- [ ] 开发者模式加载 (仅测试使用)

### 9.2 版本管理
**[请填写版本策略]**

- 初始版本号: ___________
- 版本更新频率: ___________
- 是否需要自动更新: [ ] 是  [ ] 否

---

## 10. 时间线与里程碑

### 10.1 开发阶段
**[请填写预期时间]**

| 阶段 | 任务 | 预计时间 | 负责人 |
|-----|------|---------|--------|
| 第一阶段 | 基础框架搭建 | | |
| 第二阶段 | AI 集成与测试 | | |
| 第三阶段 | Ariba 页面交互开发 | | |
| 第四阶段 | UI/UX 完善 | | |
| 第五阶段 | 测试与修复 | | |
| 第六阶段 | 部署上线 | | |

### 10.2 关键里程碑
- [ ] 设计文档确认: ___________
- [ ] 原型完成: ___________
- [ ] 功能开发完成: ___________
- [ ] 测试完成: ___________
- [ ] 正式发布: ___________

---

## 11. 风险与挑战

### 11.1 技术风险
**[请列出预见的技术挑战]**

1. Ariba 页面结构变化导致选择器失效
   - 缓解措施: ___________

2. AI API 限流或费用问题
   - 缓解措施: ___________

3. [其他风险]
   - 缓解措施: ___________

### 11.2 业务风险
**[请列出业务层面的风险]**

1. ___________
2. ___________

---

## 12. 扩展功能 (可选)

### 12.1 未来功能规划
**[请填写后续可能需要的功能]**

- [ ] 支持多语言
- [ ] 支持更多采购系统 (SAP Ariba, Coupa, Oracle 等)
- [ ] AI 训练与优化
- [ ] 团队协作功能
- [ ] 数据分析与报表
- [ ] 其他: ___________

### 12.2 集成扩展
**[是否需要与其他系统集成]**

- [ ] ERP 系统
- [ ] CRM 系统
- [ ] 内部审批系统
- [ ] 其他: ___________

---

## 13. 附录

### 13.1 参考资料
**[请添加有用的参考链接]**

- Ariba API 文档: ___________
- 内部规范文档: ___________
- 相关技术文档: ___________

### 13.2 术语表
**[请定义项目中的专业术语]**

| 术语 | 定义 |
|-----|------|
| | |

### 13.3 联系人
**[请填写关键干系人]**

- 项目负责人: ___________
- 技术负责人: ___________
- Ariba 系统管理员: ___________
- 测试人员: ___________

---

## 文档修订历史

| 版本 | 日期 | 修订人 | 修订内容 |
|-----|------|--------|---------|
| 0.1 | 2025-11-11 | | 初始版本创建 |
| | | | |

---

**下一步行动:**
1. 填写本设计文档中所有 [请填写] 的部分
2. 与相关方确认需求
3. 开始代码实现

**文档完成后请通知开发团队,我们将基于此文档生成代码框架。**
